<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ ‡ç­¾é—­ç¯ç³»ç»Ÿéƒ¨ç½²è¯´æ˜</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 40px;
            margin-bottom: 20px;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 40px;
            font-size: 2.5em;
        }
        h2 {
            color: #34495e;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-top: 40px;
            font-size: 1.8em;
        }
        h3 {
            color: #7f8c8d;
            margin-top: 25px;
            font-size: 1.4em;
        }
        p {
            margin-bottom: 20px;
            text-align: justify;
        }
        .warning {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 4px;
            padding: 15px;
            margin: 20px 0;
            color: #856404;
        }
        .success {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 4px;
            padding: 15px;
            margin: 20px 0;
            color: #155724;
        }
        .code-block {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 4px;
            overflow-x: auto;
            font-family: 'Courier New', Courier, monospace;
            margin: 20px 0;
        }
        .architecture {
            text-align: center;
            margin: 30px 0;
        }
        .architecture img {
            max-width: 100%;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .steps {
            counter-reset: step;
            list-style-type: none;
            padding: 0;
        }
        .steps li {
            position: relative;
            padding-left: 50px;
            margin-bottom: 30px;
            line-height: 1.6;
        }
        .steps li:before {
            content: counter(step);
            counter-increment: step;
            position: absolute;
            left: 0;
            top: 0;
            width: 36px;
            height: 36px;
            background: #3498db;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
        }
        .note {
            background-color: #e8f4fd;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 20px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #3498db;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ·ï¸ æ ‡ç­¾é—­ç¯ç³»ç»Ÿéƒ¨ç½²è¯´æ˜</h1>
        
        <div class="warning">
            <strong>âš ï¸ é‡è¦æç¤ºï¼š</strong>ç”±äºå½“å‰ç¯å¢ƒç½‘ç»œé™åˆ¶ï¼Œæ— æ³•ç›´æ¥å®‰è£…Dockerã€‚è¯·ä½¿ç”¨ä»¥ä¸‹ç¦»çº¿éƒ¨ç½²æ–¹æ¡ˆæˆ–åœ¨æœ‰ç½‘ç»œè¿æ¥çš„ç¯å¢ƒä¸­éƒ¨ç½²ã€‚
        </div>

        <h2>ğŸ“‹ ç³»ç»Ÿæ¦‚è¿°</h2>
        <p>æ ‡ç­¾é—­ç¯ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºDockerçš„åé¦ˆæ•°æ®æ™ºèƒ½æ ‡ç­¾ç®¡ç†å¹³å°ï¼Œæ”¯æŒè‡ªåŠ¨æ ‡ç­¾ç”Ÿæˆã€å‘é‡èšç±»ã€æ‰¹é‡æ‰“æ ‡å’Œè¾¹ç¼˜æ ·æœ¬è¿­ä»£ä¼˜åŒ–ã€‚ç³»ç»Ÿé‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼ŒåŒ…å«APIæœåŠ¡ã€WorkeræœåŠ¡å’Œæ•°æ®åº“æœåŠ¡ã€‚</p>

        <h2>ğŸ—ï¸ ç³»ç»Ÿæ¶æ„</h2>
        <div class="architecture">
            <p><strong>ç³»ç»Ÿç»„ä»¶å…³ç³»å›¾ï¼š</strong></p>
            <div style="background-color: #f8f9fa; padding: 30px; border-radius: 8px; text-align: center;">
                <div style="display: inline-block; text-align: left;">
                    <div style="background-color: #3498db; color: white; padding: 10px 20px; border-radius: 4px; display: inline-block; margin: 5px;">ğŸ“± å¤–éƒ¨ç³»ç»Ÿ</div>
                    <div style="text-align: center;">â†“</div>
                    <div style="background-color: #e74c3c; color: white; padding: 10px 20px; border-radius: 4px; display: inline-block; margin: 5px;">ğŸ”Œ FastAPI API</div>
                    <div style="text-align: center;">â†“</div>
                    <div style="display: flex; justify-content: center; gap: 20px;">
                        <div style="background-color: #f39c12; color: white; padding: 10px 20px; border-radius: 4px; display: inline-block;">ğŸ—„ï¸ MySQL</div>
                        <div style="background-color: #9b59b6; color: white; padding: 10px 20px; border-radius: 4px; display: inline-block;">ğŸ” PostgreSQL<br>(pgvector)</div>
                    </div>
                    <div style="text-align: center;">â†“</div>
                    <div style="background-color: #2ecc71; color: white; padding: 10px 20px; border-radius: 4px; display: inline-block; margin: 5px;">âš™ï¸ Python Worker</div>
                    <div style="text-align: center;">â†“</div>
                    <div style="background-color: #34495e; color: white; padding: 10px 20px; border-radius: 4px; display: inline-block; margin: 5px;">ğŸ¤– Coze API</div>
                </div>
            </div>
        </div>

        <h2>ğŸ”§ ç¦»çº¿éƒ¨ç½²æ–¹æ¡ˆ</h2>
        
        <h3>ğŸ“‹ å‰ææ¡ä»¶</h3>
        <div class="note">
            <p>åœ¨æœ‰ç½‘ç»œè¿æ¥çš„ç¯å¢ƒä¸­å‡†å¤‡ä»¥ä¸‹ç»„ä»¶ï¼š</p>
            <ul>
                <li>Docker å’Œ Docker Compose å·²å®‰è£…</li>
                <li>é¡¹ç›®ä»£ç å·²ä¸‹è½½</li>
                <li>åŸºç¡€ Docker é•œåƒå·²æ‹‰å–</li>
            </ul>
        </div>

        <h3>ğŸš€ éƒ¨ç½²æ­¥éª¤</h3>
        <ol class="steps">
            <li>
                <strong>å‡†å¤‡åŸºç¡€é•œåƒ</strong>
                <div class="code-block">
# åœ¨æœ‰ç½‘ç»œçš„ç¯å¢ƒä¸­æ‹‰å–åŸºç¡€é•œåƒ<br>
docker pull mysql:8.0<br>
docker pull postgres:15<br>
docker pull python:3.8-slim<br>
<br>
# ä¿å­˜é•œåƒä¸ºæ–‡ä»¶<br>
docker save -o mysql-8.0.tar mysql:8.0<br>
docker save -o postgres-15.tar postgres:15<br>
docker save -o python-3.8-slim.tar python:3.8-slim<br>
<br>
# å°†é•œåƒæ–‡ä»¶å¤åˆ¶åˆ°ç›®æ ‡æœåŠ¡å™¨å¹¶åŠ è½½<br>
docker load -i mysql-8.0.tar<br>
docker load -i postgres-15.tar<br>
docker load -i python-3.8-slim.tar
                </div>
            </li>
            
            <li>
                <strong>é…ç½®ç¯å¢ƒå˜é‡</strong>
                <div class="code-block">
# å¤åˆ¶ç¯å¢ƒå˜é‡ç¤ºä¾‹æ–‡ä»¶å¹¶é…ç½®<br>
cp .env.example .env<br>
<br>
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œè®¾ç½®æ•°æ®åº“å¯†ç å’ŒAPIå¯†é’¥<br>
# MYSQL_PASSWORD=your_secure_mysql_password<br>
# PG_PASSWORD=your_secure_postgres_password<br>
# API_KEY=your_secure_api_key_for_fastapi<br>
# COZE_API_KEY=your_coze_api_key<br>
# COZE_APP_ID=your_coze_app_id
                </div>
            </li>
            
            <li>
                <strong>æ„å»ºå¹¶å¯åŠ¨æœåŠ¡</strong>
                <div class="code-block">
# ä½¿ç”¨ç¦»çº¿æ¨¡å¼æ„å»ºé•œåƒ<br>
docker-compose -f docker-compose.offline.yml build --no-cache<br>
<br>
# å¯åŠ¨æ‰€æœ‰æœåŠ¡<br>
docker-compose -f docker-compose.offline.yml up -d<br>
<br>
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€<br>
docker-compose -f docker-compose.offline.yml ps
                </div>
            </li>
        </ol>

        <h2>ğŸŒ åœ¨çº¿éƒ¨ç½²æ–¹æ¡ˆ</h2>
        
        <h3>ğŸ“‹ å‰ææ¡ä»¶</h3>
        <ul>
            <li>Ubuntu 20.04+ æœåŠ¡å™¨</li>
            <li>root ç”¨æˆ·æƒé™</li>
            <li>ç¨³å®šçš„ç½‘ç»œè¿æ¥</li>
            <li>é˜¿é‡Œäº‘ VPC ç½‘ç»œç¯å¢ƒ</li>
        </ul>
        
        <h4>ğŸŒ ç½‘ç»œç«¯å£é…ç½®è¦æ±‚</h4>
        <div class="note">
            <p><strong>å…¬ç½‘è®¿é—®ï¼ˆå‡ºè¡Œï¼‰ï¼š</strong></p>
            <ul>
                <li>8001/tcp - FastAPI API æ¥å£ï¼ˆå¿…é¡»å¼€æ”¾ï¼Œä¾› Coze å…¬ç½‘è°ƒç”¨ï¼‰</li>
            </ul>
            <p><strong>VPC å†…éƒ¨è®¿é—®ï¼ˆå…¥è¡Œï¼‰ï¼š</strong></p>
            <ul>
                <li>3306/tcp - MySQL æ•°æ®åº“ï¼ˆä»… VPC å†…éƒ¨è®¿é—®ï¼‰</li>
                <li>5432/tcp - PostgreSQL æ•°æ®åº“ï¼ˆä»… VPC å†…éƒ¨è®¿é—®ï¼‰</li>
                <li>8001/tcp - FastAPI API æ¥å£ï¼ˆVPC å†…éƒ¨ä¹Ÿå¯è®¿é—®ï¼‰</li>
            </ul>
            <p><strong>å®‰å…¨ç»„é…ç½®ï¼š</strong></p>
            <ul>
                <li>å…¥æ–¹å‘ï¼šå¼€æ”¾ 8001 ç«¯å£ç»™ Coze æœåŠ¡å™¨ IP</li>
                <li>å…¥æ–¹å‘ï¼šå¼€æ”¾ 3306ã€5432 ç«¯å£ç»™ VPC å†…éƒ¨å…¶ä»–æœåŠ¡å™¨</li>
                <li>å‡ºæ–¹å‘ï¼šå…è®¸æ‰€æœ‰ç«¯å£è®¿é—®ï¼ˆæˆ–æ ¹æ®å®é™…éœ€æ±‚é…ç½®ï¼‰</li>
            </ul>
        </div>

        <h3>ğŸš€ å¿«é€Ÿéƒ¨ç½²</h3>
        <div class="code-block">
# ç»™éƒ¨ç½²è„šæœ¬æ·»åŠ æ‰§è¡Œæƒé™<br>
chmod +x deploy.sh<br>
<br>
# è¿è¡Œéƒ¨ç½²è„šæœ¬ï¼ˆé€‰æ‹©å®Œæ•´å®‰è£…ï¼‰<br>
./deploy.sh<br>
<br>
# é€‰æ‹©é€‰é¡¹ 1 è¿›è¡Œå®Œæ•´å®‰è£…
        </div>
        
        <h3>ğŸŒ å›½å†…ç½‘ç»œä¼˜åŒ–é…ç½®</h3>
        <div class="note">
            <p><strong>ä¸ºè§£å†³å›½å†…ç½‘ç»œç¯å¢ƒä¸‹çš„Dockeré•œåƒæ‹‰å–å’Œä¾èµ–å®‰è£…é—®é¢˜ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹ä¼˜åŒ–æ­¥éª¤ï¼š</strong></p>
        </div>
        
        <h4>1. é…ç½®Dockeré˜¿é‡Œäº‘é•œåƒåŠ é€Ÿ</h4>
        <div class="code-block">
# åˆ›å»ºDockeré…ç½®ç›®å½•<br>
mkdir -p /etc/docker<br>
<br>
# é…ç½®é˜¿é‡Œäº‘Dockeré•œåƒåŠ é€Ÿå™¨<br>
cat > /etc/docker/daemon.json << 'EOF'<br>
{<br>
  "registry-mirrors": [<br>
    "https://registry.cn-hangzhou.aliyuncs.com",<br>
    "https://registry.cn-shanghai.aliyuncs.com",<br>
    "https://registry.cn-shenzhen.aliyuncs.com"<br>
  ]<br>
}<br>
EOF<br>
<br>
# é‡å¯DockeræœåŠ¡<br>
systemctl daemon-reload<br>
systemctl restart docker<br>
<br>
# éªŒè¯é…ç½®æ˜¯å¦ç”Ÿæ•ˆ<br>
docker info | grep "Registry Mirrors"
        </div>
        
        <h4>2. é…ç½®pipé˜¿é‡Œäº‘æº</h4>
        <div class="code-block">
# åˆ›å»ºpipé…ç½®ç›®å½•<br>
mkdir -p ~/.pip<br>
<br>
# é…ç½®pipé˜¿é‡Œäº‘æº<br>
cat > ~/.pip/pip.conf << 'EOF'<br>
[global]<br>
index-url = https://mirrors.aliyun.com/pypi/simple/<br>
<br>
[install]<br>
trusted-host=mirrors.aliyun.com<br>
EOF<br>
<br>
# éªŒè¯pipæºé…ç½®<br>
pip config list
        </div>
        
        <h4>3. é…ç½®apté˜¿é‡Œäº‘æºï¼ˆUbuntuç³»ç»Ÿï¼‰</h4>
        <div class="code-block">
# å¤‡ä»½åŸæœ‰æºæ–‡ä»¶<br>
cp /etc/apt/sources.list /etc/apt/sources.list.bak<br>
<br>
# é…ç½®é˜¿é‡Œäº‘aptæº<br>
cat > /etc/apt/sources.list << 'EOF'<br>
deb http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse<br>
deb-src http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse<br>
<br>
deb http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse<br>
deb-src http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse<br>
<br>
deb http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse<br>
deb-src http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse<br>
<br>
deb http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse<br>
deb-src http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse<br>
<br>
deb http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse<br>
deb-src http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse<br>
EOF<br>
<br>
# æ›´æ–°aptç¼“å­˜<br>
apt-get clean<br>
apt-get update
        </div>
        
        <h4>4. é¢„æ‹‰å–åŸºç¡€Dockeré•œåƒ</h4>
        <div class="code-block">
# æ‹‰å–MySQLé•œåƒ<br>
docker pull registry.cn-hangzhou.aliyuncs.com/library/mysql:8.0<br>
docker tag registry.cn-hangzhou.aliyuncs.com/library/mysql:8.0 mysql:8.0<br>
<br>
# æ‹‰å–PostgreSQLé•œåƒ<br>
docker pull registry.cn-hangzhou.aliyuncs.com/library/postgres:15<br>
docker tag registry.cn-hangzhou.aliyuncs.com/library/postgres:15 postgres:15<br>
<br>
# æ‹‰å–Pythoné•œåƒ<br>
docker pull registry.cn-hangzhou.aliyuncs.com/library/python:3.8-slim<br>
docker tag registry.cn-hangzhou.aliyuncs.com/library/python:3.8-slim python:3.8-slim
        </div>
        
        <h4>5. ä¿®æ”¹Docker Composeé…ç½®ä½¿ç”¨å›½å†…é•œåƒ</h4>
        <div class="code-block">
# åˆ›å»ºå›½å†…é•œåƒç‰ˆæœ¬çš„docker-composeæ–‡ä»¶<br>
cp docker-compose.offline.yml docker-compose.aliyun.yml<br>
<br>
# ä½¿ç”¨sedå‘½ä»¤æ‰¹é‡æ›¿æ¢é•œåƒæºï¼ˆå®é™…æ‰§è¡Œä»£ç ï¼‰<br>
sed -i 's|mysql:8.0|registry.cn-hangzhou.aliyuncs.com/library/mysql:8.0|g' docker-compose.aliyun.yml<br>
sed -i 's|postgres:15|registry.cn-hangzhou.aliyuncs.com/library/postgres:15|g' docker-compose.aliyun.yml<br>
sed -i 's|python:3.8-slim|registry.cn-hangzhou.aliyuncs.com/library/python:3.8-slim|g' docker-compose.aliyun.yml<br>
<br>
# æŸ¥çœ‹ä¿®æ”¹åçš„é…ç½®æ–‡ä»¶<br>
grep "image:" docker-compose.aliyun.yml<br>
<br>
# ä½¿ç”¨å›½å†…é•œåƒç‰ˆæœ¬å¯åŠ¨æœåŠ¡<br>
docker-compose -f docker-compose.aliyun.yml up -d
        </div>
        
        <h3>ğŸ”’ é˜¿é‡Œäº‘å®‰å…¨ç»„é…ç½®æ­¥éª¤</h3>
        <ol class="steps">
            <li>
                <strong>ç™»å½•é˜¿é‡Œäº‘æ§åˆ¶å°</strong>
                <p>è®¿é—® <a href="https://ecs.console.aliyun.com/" target="_blank">é˜¿é‡Œäº‘ECSæ§åˆ¶å°</a> å¹¶ç™»å½•æ‚¨çš„è´¦å·</p>
            </li>
            <li>
                <strong>æ‰¾åˆ°ç›®æ ‡ECSå®ä¾‹</strong>
                <p>åœ¨å®ä¾‹åˆ—è¡¨ä¸­æ‰¾åˆ°IPä¸º <code>8.148.202.136</code> çš„ECSå®ä¾‹</p>
            </li>
            <li>
                <strong>é…ç½®å®‰å…¨ç»„è§„åˆ™</strong>
                <div class="code-block">
# å…¥æ–¹å‘è§„åˆ™é…ç½®<br>
1. åè®®ç±»å‹ï¼šTCP<br>
2. ç«¯å£èŒƒå›´ï¼š8001/8001<br>
3. æˆæƒå¯¹è±¡ï¼š0.0.0.0/0ï¼ˆæˆ–CozeæœåŠ¡å™¨IPæ®µï¼‰<br>
4. æè¿°ï¼šFastAPI APIæ¥å£ï¼ˆå…¬ç½‘è®¿é—®ï¼‰<br>
<br>
# VPCå†…éƒ¨è®¿é—®è§„åˆ™<br>
1. åè®®ç±»å‹ï¼šTCP<br>
2. ç«¯å£èŒƒå›´ï¼š3306/3306<br>
3. æˆæƒå¯¹è±¡ï¼šVPCç½‘æ®µï¼ˆå¦‚172.16.0.0/12ï¼‰<br>
4. æè¿°ï¼šMySQLæ•°æ®åº“ï¼ˆVPCå†…éƒ¨è®¿é—®ï¼‰<br>
<br>
1. åè®®ç±»å‹ï¼šTCP<br>
2. ç«¯å£èŒƒå›´ï¼š5432/5432<br>
3. æˆæƒå¯¹è±¡ï¼šVPCç½‘æ®µï¼ˆå¦‚172.16.0.0/12ï¼‰<br>
4. æè¿°ï¼šPostgreSQLæ•°æ®åº“ï¼ˆVPCå†…éƒ¨è®¿é—®ï¼‰
                </div>
            </li>
            <li>
                <strong>åº”ç”¨å®‰å…¨ç»„é…ç½®</strong>
                <p>ç‚¹å‡»"ç¡®å®š"ä¿å­˜é…ç½®ï¼Œç­‰å¾…é…ç½®ç”Ÿæ•ˆ</p>
            </li>
        </ol>

        <h2>ğŸ“Š æœåŠ¡ç»„ä»¶è¯´æ˜</h2>
        <table>
            <tr>
                <th>æœåŠ¡åç§°</th>
                <th>å®¹å™¨åç§°</th>
                <th>ç«¯å£</th>
                <th>å®ä¾‹ä¿¡æ¯</th>
                <th>è¯´æ˜</th>
            </tr>
            <tr>
                <td>MySQL</td>
                <td>feedback-mysql</td>
                <td>3306</td>
                <td>å®ä¾‹ID: rm-7xv26nb6109rln469</td>
                <td>å­˜å‚¨åŸå§‹åé¦ˆæ•°æ®å’Œæ ‡ç­¾ç»“æœ</td>
            </tr>
            <tr>
                <td>PostgreSQL</td>
                <td>feedback-postgres</td>
                <td>5432</td>
                <td>å®ä¾‹ID: pgm-7xvwb5g00mgfsv56</td>
                <td>å­˜å‚¨å‘é‡æ•°æ®å’Œæ ‡ç­¾èšç±»</td>
            </tr>
            <tr>
                <td>FastAPI API</td>
                <td>feedback-api</td>
                <td>8001</td>
                <td>ECS IP: 8.148.202.136</td>
                <td>æä¾›æ•°æ®æ’å…¥å’ŒæŸ¥è¯¢æ¥å£</td>
            </tr>
            <tr>
                <td>Python Worker</td>
                <td>feedback-worker</td>
                <td>-</td>
                <td>ECS IP: 8.148.202.136</td>
                <td>æ‰§è¡Œæ ‡ç­¾ç”Ÿæˆå’ŒåŒ¹é…ä»»åŠ¡</td>
            </tr>
            <tr>
                <td>Worker Cron</td>
                <td>feedback-worker-cron</td>
                <td>-</td>
                <td>ECS IP: 8.148.202.136</td>
                <td>å®šæ—¶æ‰§è¡Œæ ‡ç­¾é—­ç¯æµç¨‹</td>
            </tr>
        </table>
        
        <div class="note">
            <p><strong>é‡è¦æç¤ºï¼š</strong></p>
            <ul>
                <li>MySQLå®ä¾‹ (rm-7xv26nb6109rln469) å’Œ PostgreSQLå®ä¾‹ (pgm-7xvwb5g00mgfsv56) å·²å­˜åœ¨äºVPCç½‘ç»œä¸­</li>
                <li>æœ¬éƒ¨ç½²æ–¹æ¡ˆå°†åœ¨ECSæœåŠ¡å™¨ (8.148.202.136) ä¸Šè¿è¡ŒDockerå®¹å™¨ï¼Œè¿æ¥åˆ°ç°æœ‰æ•°æ®åº“å®ä¾‹</li>
                <li>è¯·ç¡®ä¿ECSæœåŠ¡å™¨ä¸æ•°æ®åº“å®ä¾‹åœ¨åŒä¸€VPCç½‘ç»œä¸­ï¼Œå¹¶ä¸”å·²é…ç½®æ­£ç¡®çš„å®‰å…¨ç»„è§„åˆ™</li>
            </ul>
        </div>

        <h2>ğŸ”— API æ¥å£è¯´æ˜</h2>
        
        <h3>ğŸ“¥ æ•°æ®æ’å…¥æ¥å£</h3>
        <div class="code-block">
POST http://æœåŠ¡å™¨IP:8001/insert_feedback<br>
<br>
Headers:<br>
X-API-Key: your_api_key<br>
Content-Type: application/json<br>
<br>
Body:<br>
{
    "feedback_list": [
        {
            "product": "äº§å“A",
            "content": "è¿™æ˜¯ä¸€æ¡åé¦ˆå†…å®¹",
            "channel": "app",
            "create_time": "2024-01-01 12:00:00"
        }
    ]
}
        </div>

        <h3>ğŸ” å¥åº·æ£€æŸ¥æ¥å£</h3>
        <div class="code-block">
GET http://æœåŠ¡å™¨IP:8001/health<br>
<br>
Response:<br>
{
    "status": "healthy",
    "service": "feedback-api",
    "timestamp": "2024-01-01T12:00:00"
}
        </div>

        <h3>ğŸ“ˆ ç»Ÿè®¡ä¿¡æ¯æ¥å£</h3>
        <div class="code-block">
GET http://æœåŠ¡å™¨IP:8001/stats<br>
<br>
Response:<br>
{
    "total_records": 1000,
    "today_records": 100,
    "status_distribution": {
        "0": 500,
        "1": 450,
        "2": 50
    }
}
        </div>

        <h2>ğŸ“ ä½¿ç”¨è¯´æ˜</h2>
        
        <h3>ğŸ¯ æ ‡ç­¾é—­ç¯æµç¨‹</h3>
        <ol class="steps">
            <li><strong>æ•°æ®æ”¶é›†</strong>ï¼šé€šè¿‡ API æ¥å£æ’å…¥åé¦ˆæ•°æ®</li>
            <li><strong>åˆ†å±‚æŠ½æ ·</strong>ï¼šç³»ç»Ÿè‡ªåŠ¨å¯¹æ•°æ®è¿›è¡Œåˆ†å±‚æŠ½æ ·</li>
            <li><strong>æ ‡ç­¾ç”Ÿæˆ</strong>ï¼šè°ƒç”¨ Coze API ç”Ÿæˆåˆå§‹æ ‡ç­¾</li>
            <li><strong>å‘é‡èšç±»</strong>ï¼šå¯¹æ ‡ç­¾å‘é‡è¿›è¡Œèšç±»ä¼˜åŒ–</li>
            <li><strong>æ‰¹é‡æ‰“æ ‡</strong>ï¼šä¸ºæ‰€æœ‰æ•°æ®åŒ¹é…æœ€ç›¸ä¼¼çš„æ ‡ç­¾</li>
            <li><strong>è¾¹ç¼˜ä¼˜åŒ–</strong>ï¼šå¯¹éš¾åŒ¹é…æ ·æœ¬è¿›è¡Œè¿­ä»£ä¼˜åŒ–</li>
        </ol>

        <h3>ğŸ”§ æ‰‹åŠ¨æ‰§è¡Œä»»åŠ¡</h3>
        <div class="code-block">
# è¿›å…¥ worker å®¹å™¨<br>
docker exec -it feedback-worker bash<br>
<br>
# æ‰§è¡Œå®Œæ•´æ ‡ç­¾é—­ç¯æµç¨‹<br>
python run_all.py<br>
<br>
# æ‰§è¡Œç‰¹å®šæ­¥éª¤<br>
python run_all.py --step 1  # ä»…æ‰§è¡Œåˆ†å±‚æŠ½æ ·<br>
python run_all.py --step 2  # ä»…æ‰§è¡Œæ ‡ç­¾ç”Ÿæˆ<br>
python run_all.py --step 3  # ä»…æ‰§è¡Œæ ‡ç­¾èšç±»<br>
python run_all.py --step 4  # ä»…æ‰§è¡Œæ‰¹é‡æ‰“æ ‡<br>
python run_all.py --step 5  # ä»…æ‰§è¡Œè¾¹ç¼˜æ ·æœ¬æ›´æ–°
        </div>

        <h2>ğŸ“Š æ—¥å¿—ç®¡ç†</h2>
        <div class="code-block">
# æŸ¥çœ‹ API æœåŠ¡æ—¥å¿—<br>
docker-compose logs -f feedback-api<br>
<br>
# æŸ¥çœ‹ Worker æœåŠ¡æ—¥å¿—<br>
docker-compose logs -f feedback-worker<br>
<br>
# æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶<br>
ls -la ./logs/<br>
tail -f ./logs/feedback-api.log<br>
tail -f ./logs/worker.log
        </div>

        <h2>ğŸ”§ å¸¸è§é—®é¢˜æ’æŸ¥</h2>
        
        <h3>ğŸš« æœåŠ¡å¯åŠ¨å¤±è´¥</h3>
        <div class="note">
            <p><strong>æ£€æŸ¥æ­¥éª¤ï¼š</strong></p>
            <ol>
                <li>æŸ¥çœ‹å®¹å™¨æ—¥å¿—ï¼š<code>docker-compose logs æœåŠ¡åç§°</code></li>
                <li>æ£€æŸ¥ç«¯å£å ç”¨ï¼š<code>netstat -tlnp | grep ç«¯å£å·</code></li>
                <li>æ£€æŸ¥ç¯å¢ƒå˜é‡ï¼š<code>cat .env</code></li>
                <li>é‡å¯æœåŠ¡ï¼š<code>docker-compose restart æœåŠ¡åç§°</code></li>
            </ol>
        </div>

        <h3>ğŸŒ API æ¥å£æ— æ³•è®¿é—®</h3>
        <div class="note">
            <p><strong>æ’æŸ¥æ­¥éª¤ï¼š</strong></p>
            <ol>
                <li>æ£€æŸ¥ API æœåŠ¡çŠ¶æ€ï¼š<code>docker-compose ps feedback-api</code></li>
                <li>æ£€æŸ¥é˜²ç«å¢™è®¾ç½®ï¼š<code>ufw status</code></li>
                <li>æµ‹è¯•æœ¬åœ°è®¿é—®ï¼š<code>curl http://localhost:8001/health</code></li>
                <li>æ£€æŸ¥ API å¯†é’¥ï¼šç¡®è®¤è¯·æ±‚å¤´ä¸­çš„ X-API-Key æ˜¯å¦æ­£ç¡®</li>
            </ol>
        </div>

        <h3>ğŸ’¾ æ•°æ®åº“è¿æ¥é—®é¢˜</h3>
        <div class="note">
            <p><strong>æ’æŸ¥æ­¥éª¤ï¼š</strong></p>
            <ol>
                <li>æ£€æŸ¥æ•°æ®åº“æœåŠ¡çŠ¶æ€</li>
                <li>éªŒè¯æ•°æ®åº“å‡­è¯</li>
                <li>æµ‹è¯•æ•°æ®åº“è¿æ¥</li>
                <li>æ£€æŸ¥ç½‘ç»œé…ç½®</li>
            </ol>
        </div>

        <h2>ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®</h2>
        <ul>
            <li><strong>æ•°æ®åº“ä¼˜åŒ–</strong>ï¼šå®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®ï¼Œåˆ›å»ºåˆé€‚çš„ç´¢å¼•</li>
            <li><strong>èµ„æºé…ç½®</strong>ï¼šæ ¹æ®æ•°æ®é‡è°ƒæ•´å®¹å™¨å†…å­˜å’ŒCPUé™åˆ¶</li>
            <li><strong>æ‰¹é‡å¤„ç†</strong>ï¼šå¤§æ‰¹é‡æ•°æ®æ’å…¥æ—¶ä½¿ç”¨æ‰¹é‡æ¥å£</li>
            <li><strong>å®šæ—¶ä»»åŠ¡</strong>ï¼šè°ƒæ•´ cron ä»»åŠ¡æ‰§è¡Œé¢‘ç‡ï¼Œé¿å¼€ä¸šåŠ¡é«˜å³°æœŸ</li>
        </ul>

        <div class="success">
            <strong>ğŸ‰ éƒ¨ç½²å®Œæˆï¼</strong><br>
            ç³»ç»Ÿéƒ¨ç½²æˆåŠŸåï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ï¼š<br>
            - API æ¥å£ï¼šhttp://æœåŠ¡å™¨IP:8001<br>
            - å¥åº·æ£€æŸ¥ï¼šhttp://æœåŠ¡å™¨IP:8001/health<br>
            - ç»Ÿè®¡ä¿¡æ¯ï¼šhttp://æœåŠ¡å™¨IP:8001/stats<br>
            <br>
            è¯·ç¡®ä¿åœ¨é˜¿é‡Œäº‘å®‰å…¨ç»„ä¸­å¼€æ”¾äº†ç›¸åº”çš„ç«¯å£ï¼Œå¹¶é…ç½®äº†æ­£ç¡®çš„ API å¯†é’¥ã€‚
        </div>
    </div>
</body>
</html>